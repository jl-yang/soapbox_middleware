<html>
    <head>
		
		<script src="sockjs.js"></script>
		<script src="stomp.js"></script>
		
		<title>RTCPeerConnection</title>

	</head>	
    <body>
        <div id="container">
            <video id="localVideo" autoplay muted></video>         			
        </div>
		<script src="adapter.js"></script>
        <script src="soapbox_api.js"></script>
		
		<script>
			var localVideo = document.getElementById('localVideo');
			var localStream;
			console.log('Requesting local stream');
			navigator.getUserMedia(
				{
					video: true,
					audio: true
				}, 
				gotStream, 
				function (error) {
					console.log('navigator.getUserMedia error: ', error);
				}
			);
			function gotStream(stream) {   
				console.log('Received local stream');
				localStream = stream;
				localVideo.src = URL.createObjectURL(stream); 
				
				connect_to_signaling_server();
				
				//You cannot start the speech unless the connection with signaling server is okay
				start_speech(localStream);
			}
			
		</script>
		
    </body>
</html>
